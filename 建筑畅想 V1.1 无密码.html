<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å»ºç­‘è®¾è®¡æ¦‚å¿µç”Ÿæˆå™¨</title>
    <style>
body.dark-mode {
    --primary-color: #f0f0f0;
    --secondary-color: #aaaaaa;
    --accent-color: #2c2c2c;
    --text-color: #e0e0e0;
    --light-gray: #444;
    --medium-gray: #888;
    --white: #1e1e1e;
    background-color: var(--white);
    color: var(--text-color);
}
body.dark-mode .input-section,
body.dark-mode .output-section,
body.dark-mode .api-settings {
    background-color: var(--accent-color);
    box-shadow: none;
}
body.dark-mode .generate-btn,
body.dark-mode .save-api-btn {
    background-color: #444;
    color: var(--text-color);
}
body.dark-mode .generate-btn:hover,
body.dark-mode .save-api-btn:hover {
    background-color: #666;
}
body.dark-mode .tab.active {
    border-bottom: 2px solid var(--primary-color);
    color: var(--primary-color);
}
body.dark-mode .concept-result {
    background-color: #3a3a3a;
    color: var(--text-color);
    max-height: 500px;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
}
body.dark-mode .notification {
    background-color: #444;
    color: var(--text-color);
}
body.dark-mode .notification.error {
    background-color: #ff3b30;
    color: var(--text-color);
}
body.dark-mode header h1,
body.dark-mode header p,
body.dark-mode .input-section h2,
body.dark-mode .output-section h2,
body.dark-mode .concept-title,
body.dark-mode .concept-content,
body.dark-mode .progress-text,
body.dark-mode .estimated-time,
body.dark-mode footer p,
body.dark-mode .history-item {
    color: var(--primary-color);
}
body.dark-mode .history-item {
    background-color: var(--accent-color);
}
body.dark-mode .history-item .delete-btn {
    filter: grayscale(100%);
}

:root {
    --primary-color: #000000;
    --secondary-color: #666666;
    --accent-color: #f5f5f7;
    --text-color: #1d1d1f;
    --light-gray: #e0e0e0;
    --medium-gray: #86868b;
    --white: #ffffff;
    --shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
    --radius: 8px;
    --font-sans: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Helvetica Neue', Arial, sans-serif;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: var(--font-sans);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

body {
    background-color: #ffffff;
    color: var(--text-color);
    line-height: 1.5;
    font-weight: 300;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 3rem 2rem;
}

header {
    text-align: center;
    margin-bottom: 4rem;
    padding: 2rem 0;
    position: relative;
}

header h1 {
    color: var(--primary-color);
    font-size: 3.2rem;
    margin-bottom: 1rem;
    font-weight: 500;
    letter-spacing: -0.02em;
}

header p {
    font-size: 1.5rem;
    color: var(--secondary-color);
    max-width: 700px;
    margin: 0 auto;
    font-weight: 300;
    letter-spacing: 0.01em;
}

.main-content {
    display: flex;
    gap: 2.5rem;
    margin-bottom: 2.5rem;
}

.input-section {
    flex: 1;
    background-color: var(--white);
    padding: 2.5rem;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.input-section:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
}

.input-section h2 {
    color: var(--primary-color);
    margin-bottom: 2rem;
    font-size: 1.8rem;
    font-weight: 500;
    letter-spacing: -0.01em;
}

.input-group {
    margin-bottom: 2rem;
}

.input-group label {
    display: block;
    margin-bottom: 0.7rem;
    font-weight: 500;
    color: var(--primary-color);
    font-size: 1rem;
    letter-spacing: 0.01em;
}

.input-group input, .input-group select {
    width: 100%;
    padding: 0.9rem 1rem;
    border: 1px solid var(--light-gray);
    border-radius: var(--radius);
    font-size: 1rem;
    transition: all 0.3s ease;
    background-color: #f5f5f7;
}

.input-group input:focus, .input-group select:focus {
    border-color: var(--primary-color);
    outline: none;
    background-color: #ffffff;
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.05);
}

.select-input {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23000000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right 1rem center;
    background-size: 1em;
    cursor: pointer;
}

.generate-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
    padding: 1rem 2rem;
    font-size: 1.1rem;
    border-radius: var(--radius);
    cursor: pointer;
    transition: all 0.3s ease;
    width: 100%;
    margin-top: 1.5rem;
    font-weight: 400;
    letter-spacing: 0.02em;
}

.generate-btn:hover {
    background-color: #333333;
    transform: translateY(-2px);
}

.generate-btn:active {
    transform: translateY(0);
}

.generate-btn:disabled {
    background-color: var(--medium-gray);
    cursor: not-allowed;
    transform: none;
}

.output-section {
    flex: 2;
    background-color: var(--white);
    padding: 2.5rem;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    min-height: 600px;
    display: flex;
    flex-direction: column;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.output-section:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
}

.output-section h2 {
    color: var(--primary-color);
    margin-bottom: 2rem;
    font-size: 1.8rem;
    font-weight: 500;
    letter-spacing: -0.01em;
}

.concept-result {
    flex: 1;
    background-color: var(--accent-color);
    padding: 2rem;
    border-radius: var(--radius);
    overflow-y: auto;
    white-space: pre-wrap;
    line-height: 1.6;
    font-size: 1.05rem;
    color: var(--text-color);
    max-height: 500px;
    scrollbar-width: thin;
    scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
}

.progress-bar-container {
    width: 100%;
    height: 6px;
    background-color: var(--light-gray);
    border-radius: 3px;
    overflow: hidden;
    margin-bottom: 0.7rem;
}

.progress-bar {
    height: 100%;
    background-color: var(--primary-color);
    width: 0%;
    transition: width 0.3s ease;
}

.progress-text {
    font-size: 0.9rem;
    color: var(--medium-gray);
    text-align: center;
    letter-spacing: 0.01em;
}

.estimated-time {
    font-size: 0.9rem;
    color: var(--medium-gray);
    text-align: center;
    margin-top: 0.5rem;
}

.concept-title {
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
    color: var(--primary-color);
    font-weight: 500;
    letter-spacing: -0.01em;
    position: relative;
}

.loading {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%;
}

.spinner {
    border: 3px solid rgba(0, 0, 0, 0.1);
    width: 30px;
    height: 30px;
    border-radius: 50%;
    border-left-color: var(--primary-color);
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.section-tabs {
    display: flex;
    margin-bottom: 1.5rem;
    border-bottom: 1px solid var(--light-gray);
}

.tab {
    padding: 0.8rem 1.5rem;
    background-color: transparent;
    border: none;
    cursor: pointer;
    margin-right: 1rem;
    transition: all 0.3s ease;
    font-size: 1rem;
    font-weight: 500;
    color: var(--medium-gray);
    border-bottom: 2px solid transparent;
    margin-bottom: -1px;
}

.tab.active {
    color: var(--primary-color);
    border-bottom: 2px solid var(--primary-color);
}

.tab:hover:not(.active) {
    color: #333333;
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
    animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.concept-section {
    margin-top: 1.5rem;
}

.concept-section .concept-title {
    color: var(--primary-color);
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
    font-weight: 500;
    letter-spacing: -0.01em;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--light-gray);
}

.concept-content {
    font-weight: 300;
    letter-spacing: 0.01em;
    line-height: 1.8;
    font-size: 1.1rem;
    color: var(--text-color);
    margin-bottom: 1.5rem;
}

.concept-content p {
    margin-bottom: 1.2rem;
    line-height: 1.7;
}

.concept-content p:last-child {
    margin-bottom: 0;
}

.concept-content strong {
    font-weight: 500;
    color: var(--primary-color);
}

.concept-content em {
    font-style: italic;
}

.notification {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 12px 20px;
    background-color: var(--primary-color);
    color: white;
    border-radius: var(--radius);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 1000;
    opacity: 0;
    transform: translateY(-20px);
    transition: all 0.3s ease;
    font-weight: 400;
    font-size: 0.95rem;
}

.notification.show {
    opacity: 1;
    transform: translateY(0);
}

.notification.error {
    background-color: #ff3b30;
}

.notification.warning {
    background-color: #ff9500;
}

footer {
    margin-top: 2rem;
    text-align: center;
    color: var(--medium-gray);
    font-size: 0.9rem;
}

/* å¢å¼ºçš„ä¸“ä¸šå»ºç­‘é£æ ¼æ ·å¼ */
.concept-bullet {
    margin-bottom: 1rem;
    padding-left: 1rem;
}

.concept-bullet li {
    margin-bottom: 0.5rem;
    position: relative;
    padding-left: 1.2rem;
}

.concept-bullet li::before {
    content: 'â€¢';
    position: absolute;
    left: 0;
    color: var(--primary-color);
}

.concept-title::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    width: 80px;
    height: 3px;
    background-color: var(--primary-color);
}

@media (max-width: 992px) {
    .main-content {
        flex-direction: column;
    }
    
    .api-form {
        flex-direction: column;
    }
    
    .api-form .input-group {
        margin-bottom: 1.5rem;
    }
    
    .save-api-btn {
        width: 100%;
    }
    
    header h1 {
        font-size: 2.5rem;
    }
    
    header p {
        font-size: 1.2rem;
    }
}

/* Welcome screen styles */
#welcome-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--white);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
    transition: opacity 0.5s ease, visibility 0.5s ease;
    overflow: hidden;
}

#welcome-screen.hidden {
    opacity: 0;
    visibility: hidden;
}

#welcome-message {
    font-size: 1.5rem;
    color: var(--primary-color);
    text-align: center;
    animation: fadeInUp 1s ease-out;
    position: relative;
}

#welcome-title {
    font-size: 3rem;
    color: var(--primary-color);
    text-align: center;
    margin-bottom: 1rem;
    animation: fadeInUp 1s ease-out;
    position: relative;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.line {
    position: absolute;
    width: 0;
    height: 2.25px;
    background-color: var(--primary-color);
    top: 50%;
    transition: width 1.5s ease-out;
}

#line-left {
    left: 0;
    animation: lineInLeft 1.5s ease-out forwards;
}

#line-right {
    right: 0;
    animation: lineInRight 1.5s ease-out forwards;
}

/* Welcome screen line setting */

@keyframes lineInLeft {
    to {
        width: var(--line-end-width);
    }
}

@keyframes lineInRight {
    to {
        width: var(--line-end-width);
    }
}

:root {
    --line-end-width: calc(41.5% - 200px); /* Default to Chinese width */
}

body[data-language='en'] {
    --line-end-width: calc(30% - 200px);
}

/* Modern button styles */
button {
    display: inline-block;
    padding: 0.6rem 1.2rem;
    margin: 0.5rem;
    font-size: 1rem;
    font-weight: 500;
    color: var(--text-color);
    background-color: transparent;
    border: none;
    border-radius: var(--radius);
    cursor: pointer;
    transition: transform 0.3s ease;
}

button:hover {
    transform: translateY(-2px);
}

button:active {
    transform: translateY(0);
}

#dark-mode-toggle, #language-toggle {
    position: absolute;
    top: 0.2rem;
    right: 0.2rem;
    z-index: 60;
    filter: grayscale(100%);
}

#language-toggle {
    right: 4rem;
}

.language-transition {
    transition: all 0.5s ease;
}

.history-list {
    max-height: 200px;
    overflow-y: auto;
    margin-top: 1rem;
    border: 1px solid var(--light-gray);
    border-radius: var(--radius);
    padding: 1rem;
    background-color: var(--accent-color);
    position: relative;
    scrollbar-width: thin;
    scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
}

.history-item {
    display: flex;
    flex-direction: column;
    margin-bottom: 0.5rem;
    padding: 0.5rem;
    border: 1px solid var(--light-gray);
    border-radius: var(--radius);
    background-color: #fff;
    font-size: 0.9rem;
    color: var(--text-color);
    position: relative;
    transition: background-color 0.3s ease, transform 0.3s ease;
    cursor: pointer;
}

.history-item:hover {
    background-color: var(--light-gray);
    transform: translateY(-2px);
}

.history-item .delete-btn {
    position: absolute;
    top: 25%;
    right: -1rem;
    transform: translateY(-50%);
    background: none;
    border: none;
    font-size: 0.6rem; /* Slightly smaller size */
    cursor: pointer;
    color: #c4c4c4; /* Lighter color for light mode */
}
</style>
</head>
<body>
    <div id="welcome-screen">
        <div class="line" id="line-left" style="top: 50%; transform: translateY(-50%);"></div>
        <div class="line" id="line-right" style="top: 50%; transform: translateY(-50%);"></div>
        <div>
            <div id="welcome-title" data-en="Welcome to the Arch Vision System" data-zh="æ¬¢è¿ä½¿ç”¨å»ºç­‘ç•…æƒ³ç³»ç»Ÿ">æ¬¢è¿ä½¿ç”¨å»ºç­‘ç•…æƒ³ç³»ç»Ÿ</div>
            <div id="welcome-message" data-en="The moment when the dreams of design touches future" data-zh="æœ‰å®›æ¸ ä¹‹æ°‘ï¼Œä¹˜èˆ¹è€Œè‡³ï¼Œå…¶äººå–„ç»‡ï¼Œå…¶å›½æ®·å¯Œ">æœ‰å®›æ¸ ä¹‹æ°‘ï¼Œä¹˜èˆ¹è€Œè‡³ï¼Œå…¶äººå–„ç»‡ï¼Œå…¶å›½æ®·å¯Œ</div>
        </div>
    </div>

    <div class="container">
        <header>
            <h1 data-en="Arch Design Vision System" data-zh="å»ºç­‘ç•…æƒ³ç³»ç»Ÿ">å»ºç­‘ç•…æƒ³ç³»ç»Ÿ</h1>
            <button id="dark-mode-toggle">ğŸŒ™</button>
            <button id="language-toggle">ğŸŒ</button>
            <p data-en="Enter prompts for complete architectural concept design" data-zh="è¾“å…¥æç¤ºè¯ï¼Œè·å¾—å®Œæ•´çš„å»ºç­‘è®¾è®¡æ¦‚å¿µæ–¹æ¡ˆ">è¾“å…¥æç¤ºè¯ï¼Œè·å¾—å®Œæ•´çš„å»ºç­‘è®¾è®¡æ¦‚å¿µæ–¹æ¡ˆ</p>
        </header>
        
        <div class="main-content">
            <div class="input-section">
                <h2 data-en="Enter Prompts" data-zh="è¾“å…¥æç¤ºè¯">è¾“å…¥æç¤ºè¯</h2>
                <div class="input-group">
                    <label for="prompt-level1" data-en="Location" data-zh="åœ°ç†ä½ç½®">åœ°ç†ä½ç½®</label>
                    <input type="text" id="prompt-level1" placeholder="ä¾‹å¦‚: æ·±åœ³ï¼Œä¸Šæµ·" data-en-placeholder="e.g., Shenzhen, Shanghai" data-zh-placeholder="ä¾‹å¦‚: æ·±åœ³ï¼Œä¸Šæµ·">
                </div>
                <div class="input-group">
                    <label for="prompt-level2" data-en="Building Type" data-zh="å»ºç­‘ç±»å‹">å»ºç­‘ç±»å‹</label>
                    <select id="prompt-level2" class="select-input">
                        <option value="" disabled selected data-en="Select Building Type" data-zh="è¯·é€‰æ‹©å»ºç­‘ç±»å‹">è¯·é€‰æ‹©å»ºç­‘ç±»å‹</option>
                        <option value="é«˜ç«¯ä½å®…" data-en="High-end Residential" data-zh="é«˜ç«¯ä½å®…">é«˜ç«¯ä½å®…</option>
                        <option value="å•†ä¸šç»¼åˆä½“" data-en="Commercial Complex" data-zh="å•†ä¸šç»¼åˆä½“">å•†ä¸šç»¼åˆä½“</option>
                        <option value="åŠå…¬å»ºç­‘" data-en="Office Building" data-zh="åŠå…¬å»ºç­‘">åŠå…¬å»ºç­‘</option>
                        <option value="æ–‡åŒ–åœºé¦†" data-en="Cultural Venue" data-zh="æ–‡åŒ–åœºé¦†">æ–‡åŒ–åœºé¦†</option>
                        <option value="æ•™è‚²è®¾æ–½" data-en="Educational Facility" data-zh="æ•™è‚²è®¾æ–½">æ•™è‚²è®¾æ–½</option>
                        <option value="åŒ»ç–—å»ºç­‘" data-en="Medical Building" data-zh="åŒ»ç–—å»ºç­‘">åŒ»ç–—å»ºç­‘</option>
                        <option value="é…’åº—" data-en="Hotel" data-zh="é…’åº—">é…’åº—</option>
                        <option value="å…¬å…±ç©ºé—´" data-en="Public Space" data-zh="å…¬å…±ç©ºé—´">å…¬å…±ç©ºé—´</option>
                        <option value="äº§ä¸šå›­åŒº" data-en="Industrial Park" data-zh="äº§ä¸šå›­åŒº">äº§ä¸šå›­åŒº</option>
                        <option value="å…¶ä»–" data-en="Other (Custom)" data-zh="å…¶ä»– (è‡ªå®šä¹‰)">å…¶ä»– (è‡ªå®šä¹‰)</option>
                    </select>
                    <input type="text" id="custom-prompt-level2" placeholder="è¯·è¾“å…¥è‡ªå®šä¹‰å»ºç­‘ç±»å‹" style="display: none; margin-top: 0.5rem;" data-en-placeholder="Enter custom building type" data-zh-placeholder="è¯·è¾“å…¥è‡ªå®šä¹‰å»ºç­‘ç±»å‹">
                </div>
                <div class="input-group">
                    <label for="prompt-level3" data-en="Design Features/Cultural Attributes" data-zh="è®¾è®¡ç‰¹æ€§/äººæ–‡å±æ€§">è®¾è®¡ç‰¹æ€§/äººæ–‡å±æ€§</label>
                    <input type="text" id="prompt-level3" placeholder="ä¾‹å¦‚: ç”Ÿæ€å‹å¥½/æ—§åŸæ”¹é€ /ç«‹é¢è®¾è®¡/æ–‡åŒ–å…ƒç´ " data-en-placeholder="e.g., Eco-friendly/Urban Renewal/Facade Design/Cultural Elements" data-zh-placeholder="ä¾‹å¦‚: ç”Ÿæ€å‹å¥½/æ—§åŸæ”¹é€ /ç«‹é¢è®¾è®¡/æ–‡åŒ–å…ƒç´ ">
                </div>
                <div class="input-group">
                    <label for="prompt-level4" data-en="Building Area (sqm)" data-zh="å»ºç­‘é¢ç§¯ (å¹³æ–¹ç±³)">å»ºç­‘é¢ç§¯ (å¹³æ–¹ç±³)</label>
                    <input type="number" id="prompt-level4" placeholder="ä¾‹å¦‚: 5000" data-en-placeholder="e.g., 5000" data-zh-placeholder="ä¾‹å¦‚: 5000">
                </div>
                <button id="generate-btn" class="generate-btn" disabled data-en="Start Visioning" data-zh="å¼€å§‹ç•…æƒ³">å¼€å§‹ç•…æƒ³</button>
                <div id="progress-container" style="display: none; margin-top: 1rem;">
                    <div class="progress-bar-container">
                        <div id="progress-bar" class="progress-bar"></div>
                    </div>
                    <div id="progress-text" class="progress-text" data-en="Conceptualizing (0%)..." data-zh="æ–¹æ¡ˆæ„æƒ³ä¸­ (0%)...">æ–¹æ¡ˆæ„æƒ³ä¸­ (0%)...</div>
                    <div id="estimated-time" class="estimated-time" data-en="Estimated time remaining: 100 seconds" data-zh="é¢„è®¡å‰©ä½™æ—¶é—´: 100ç§’">é¢„è®¡å‰©ä½™æ—¶é—´: 100ç§’</div>
                </div>
            </div>
            
            <div class="output-section">
                <h2 data-en="Design Concept Plan" data-zh="è®¾è®¡æ¦‚å¿µæ–¹æ¡ˆ">è®¾è®¡æ¦‚å¿µæ–¹æ¡ˆ</h2>
                <div class="section-tabs">
                    <button class="tab active" data-tab="concept" data-en="Design Concept" data-zh="è®¾è®¡æ¦‚å¿µ">è®¾è®¡æ¦‚å¿µ</button>
                    <button class="tab" data-tab="details" data-en="Details" data-zh="ç»†èŠ‚è¯´æ˜">ç»†èŠ‚è¯´æ˜</button>
                    <button class="tab" data-tab="inspiration" data-en="Inspiration" data-zh="è®¾è®¡çµæ„Ÿ">è®¾è®¡çµæ„Ÿ</button>
                </div>
                
                <div id="concept-tab" class="tab-content active">
                    <div id="concept-result" class="concept-result">
                        <div class="concept-title" data-en="Design Concept will be displayed here" data-zh="è®¾è®¡æ¦‚å¿µå°†åœ¨è¿™é‡Œæ˜¾ç¤º">è®¾è®¡æ¦‚å¿µå°†åœ¨è¿™é‡Œæ˜¾ç¤º</div>
                        <p data-en="Please enter detailed prompts on the left and click the 'Generate Design Concept' button." data-zh="è¯·åœ¨å·¦ä¾§è¾“å…¥æç¤ºè¯ï¼Œç„¶åç‚¹å‡»'ç”Ÿæˆè¯¦ç»†è®¾è®¡æ¦‚å¿µ'æŒ‰é’®ã€‚">è¯·åœ¨å·¦ä¾§è¾“å…¥æç¤ºè¯ï¼Œç„¶åç‚¹å‡»"ç”Ÿæˆè¯¦ç»†è®¾è®¡æ¦‚å¿µ"æŒ‰é’®ã€‚</p>
                    </div>
                </div>
                
                <div id="details-tab" class="tab-content">
                    <div id="details-result" class="concept-result">
                        <div class="concept-title" data-en="Details will be displayed here" data-zh="ç»†èŠ‚è¯´æ˜å°†åœ¨è¿™é‡Œæ˜¾ç¤º">ç»†èŠ‚è¯´æ˜å°†åœ¨è¿™é‡Œæ˜¾ç¤º</div>
                        <p data-en="Please generate the design concept first." data-zh="è¯·é¦–å…ˆç”Ÿæˆè®¾è®¡æ¦‚å¿µã€‚">è¯·é¦–å…ˆç”Ÿæˆè®¾è®¡æ¦‚å¿µã€‚</p>
                    </div>
                </div>
                
                <div id="inspiration-tab" class="tab-content">
                    <div id="inspiration-result" class="concept-result">
                        <div class="concept-title" data-en="Inspiration will be displayed here" data-zh="è®¾è®¡çµæ„Ÿå°†åœ¨è¿™é‡Œæ˜¾ç¤º">è®¾è®¡çµæ„Ÿå°†åœ¨è¿™é‡Œæ˜¾ç¤º</div>
                        <p data-en="Please generate the design concept first." data-zh="è¯·é¦–å…ˆç”Ÿæˆè®¾è®¡æ¦‚å¿µã€‚">è¯·é¦–å…ˆç”Ÿæˆè®¾è®¡æ¦‚å¿µã€‚</p>
                    </div>
                </div>

                <div id="history-list" class="history-list" style="max-height: 150px; overflow-y: auto;">
                    <div id="history-items"></div>
                </div>
            </div>
        </div>
        
        <footer>
            <p data-en="Architectural Design Concept Vision Assistant V 1.0 &copy; 2025 - Atiarfei" data-zh="å»ºç­‘è®¾è®¡æ¦‚å¿µç•…æƒ³åŠ©æ‰‹V 1.0 &copy; 2025 - Atiarfei">å»ºç­‘è®¾è®¡æ¦‚å¿µç•…æƒ³åŠ©æ‰‹V 1.0 &copy; 2025 - Atiarfei</p>
        </footer>
    </div>

    <!-- é€šçŸ¥å…ƒç´  -->
    <div id="notification" class="notification" data-en="Message Notification" data-zh="æ¶ˆæ¯æç¤º">æ¶ˆæ¯æç¤º</div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ç¼“å­˜å¸¸ç”¨DOMå…ƒç´ å¼•ç”¨ - æ€§èƒ½ä¼˜åŒ–
            const elements = {
                promptLevel1: document.getElementById('prompt-level1'),
                promptLevel2: document.getElementById('prompt-level2'),
                promptLevel3: document.getElementById('prompt-level3'),
                promptLevel4: document.getElementById('prompt-level4'),
                customPromptLevel2: document.getElementById('custom-prompt-level2'),
                generateBtn: document.getElementById('generate-btn'),
                progressContainer: document.getElementById('progress-container'),
                progressBar: document.getElementById('progress-bar'),
                progressText: document.getElementById('progress-text'),
                estimatedTime: document.getElementById('estimated-time'),
                conceptResult: document.getElementById('concept-result'),
                detailsResult: document.getElementById('details-result'),
                inspirationResult: document.getElementById('inspiration-result'),
                tabs: document.querySelectorAll('.tab'),
                tabContents: document.querySelectorAll('.tab-content'),
                notification: document.getElementById('notification'),
                welcomeScreen: document.getElementById('welcome-screen'),
                languageToggle: document.getElementById('language-toggle'),
                historyList: document.getElementById('history-list'),
                historyItems: document.getElementById('history-items')
            };
            
            // åº”ç”¨ç¨‹åºçŠ¶æ€
            let appState = {
                progressInterval: null,
                currentProgress: 0,
                estimatedTimeLeft: 100,
                apiSettings: {
                    endpoint: 'https://api.deepseek.com/v1/chat/completions', // Deepseek APIç«¯ç‚¹
                    key: 'sk-f13fd71672144f5ebb1fd4b4dfeac0a0', // Deepseek APIå¯†é’¥
                },
                isGenerating: false,
                language: localStorage.getItem('language') || 'zh',
                history: JSON.parse(localStorage.getItem('history')) || []
            };
            
            // åˆå§‹åŒ–
            init();
            
            function init() {
                // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
                attachEventListeners();
                
                // å¹³æ»‘æ»šåŠ¨
                setupSmoothScrolling();
                
                // åˆå§‹çŠ¶æ€æ£€æŸ¥
                checkInputs();

                // æ˜¾ç¤ºæ¬¢è¿ç•Œé¢
                setTimeout(() => {
                    elements.welcomeScreen.classList.add('hidden');
                }, 3000);

                // è®¾ç½®åˆå§‹è¯­è¨€
                setLanguage(appState.language);

                // åŠ è½½å†å²è®°å½•
                loadHistory();
            }
            
            function attachEventListeners() {
                // ç”ŸæˆæŒ‰é’®
                elements.generateBtn.addEventListener('click', generateConcept);
                
                // å»ºç­‘ç±»å‹å˜åŒ–
                elements.promptLevel2.addEventListener('change', handleBuildingTypeChange);
                
                // æ ‡ç­¾é¡µåˆ‡æ¢
                elements.tabs.forEach(tab => {
                    tab.addEventListener('click', switchTab);
                });
                
                // è¾“å…¥å˜åŒ–æ£€æµ‹ - ä½¿ç”¨äº‹ä»¶å§”æ‰˜æé«˜æ€§èƒ½
                const inputContainer = document.querySelector('.input-section');
                inputContainer.addEventListener('input', function(e) {
                    if (e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT') {
                        checkInputs();
                    }
                });

                // è¯­è¨€åˆ‡æ¢
                elements.languageToggle.addEventListener('click', toggleLanguage);

                // æ¸…é™¤å†å²è®°å½•
                elements.historyList.addEventListener('click', function(e) {
                    if (e.target.classList.contains('delete-btn')) {
                        deleteHistoryItem(e);
                    }
                });
            }
            
            function setupSmoothScrolling() {
                document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                    anchor.addEventListener('click', function (e) {
                        e.preventDefault();
                        document.querySelector(this.getAttribute('href')).scrollIntoView({
                            behavior: 'smooth'
                        });
                    });
                });
            }
            
            // æ£€æŸ¥è¾“å…¥æ˜¯å¦å·²å¡«å†™ä»¥å¯ç”¨/ç¦ç”¨ç”ŸæˆæŒ‰é’®
            function checkInputs() {
                const promptLevel1 = elements.promptLevel1.value.trim();
                
                let promptLevel2Value;
                if (elements.promptLevel2.value === "å…¶ä»–") {
                    promptLevel2Value = elements.customPromptLevel2.value.trim();
                } else {
                    promptLevel2Value = elements.promptLevel2.value.trim();
                }
                
                const promptLevel3 = elements.promptLevel3.value.trim();
                const promptLevel4 = elements.promptLevel4.value.trim();
                
                const promptsValid = promptLevel1 && promptLevel2Value && promptLevel3 && promptLevel4;
                
                elements.generateBtn.disabled = !promptsValid || appState.isGenerating;
            }
            
            // å¤„ç†å»ºç­‘ç±»å‹å˜åŒ– - æ˜¾ç¤º/éšè—è‡ªå®šä¹‰è¾“å…¥
            function handleBuildingTypeChange() {
                if (elements.promptLevel2.value === "å…¶ä»–") {
                    elements.customPromptLevel2.style.display = "block";
                } else {
                    elements.customPromptLevel2.style.display = "none";
                }
                checkInputs();
            }
            
            // æ˜¾ç¤ºé€šçŸ¥
            function showNotification(message, type = 'info') {
                elements.notification.textContent = message;
                elements.notification.className = 'notification';
                
                if (type === 'error') {
                    elements.notification.classList.add('error');
                } else if (type === 'warning') {
                    elements.notification.classList.add('warning');
                }
                
                elements.notification.classList.add('show');
                
                setTimeout(() => {
                    elements.notification.classList.remove('show');
                }, 3000);
            }
            
            // ç”Ÿæˆè®¾è®¡æ¦‚å¿µ
            async function generateConcept() {
                if (appState.isGenerating) return;
                
                // è·å–è¾“å…¥å€¼
                const location = elements.promptLevel1.value.trim();
                let buildingType;
                
                if (elements.promptLevel2.value === "å…¶ä»–") {
                    buildingType = elements.customPromptLevel2.value.trim();
                } else {
                    buildingType = elements.promptLevel2.value.trim();
                }
                
                const developer = elements.promptLevel3.value.trim();
                const area = elements.promptLevel4.value.trim();
                
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                appState.isGenerating = true;
                elements.generateBtn.disabled = true;
                showLoading();
                
                try {
                    // æ„å»ºè¯·æ±‚æ•°æ®
                    const requestData = {
                        model: 'deepseek-reasoner',
                        messages: [
                            {
                                role: "system", 
                                content: appState.language === 'zh' ? 
                                    "ä½ æ˜¯ä¸€åä¸“ä¸šçš„å»ºç­‘è®¾è®¡æ¦‚å¿µç”Ÿæˆå™¨ã€‚æ ¹æ®ç”¨æˆ·æä¾›çš„åœ°ç†ä½ç½®ã€å»ºç­‘ç±»å‹ã€å¼€å‘å•†/ç‰¹æ€§å’Œå»ºç­‘é¢ç§¯ï¼Œç”Ÿæˆä¸€ä»½å…·æœ‰æ·±åº¦å’Œå®é™…å‚è€ƒä»·å€¼çš„å»ºç­‘è®¾è®¡æ¦‚å¿µæ–¹æ¡ˆã€‚æ–¹æ¡ˆåº”åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šæ¦‚å¿µè®¾è®¡ã€è¯¦ç»†è¯´æ˜ã€è®¾è®¡çµæ„Ÿã€‚æ¯ä¸ªéƒ¨åˆ†åº”å…·æœ‰æ˜¾è‘—çš„å·®å¼‚æ€§ï¼Œä½¿ç”¨ä¸“ä¸šçš„å»ºç­‘æœ¯è¯­å’Œè®¾è®¡ç†å¿µï¼Œç¡®ä¿å†…å®¹ç´§å‡‘ç¾è§‚ã€‚è¿›è¡Œæ–¹æ¡ˆçš„æ•´ä½“åˆ›ä½œæ—¶ï¼Œåº”è¯¥å…·æœ‰ä¸“ä¸šå»ºç­‘å¸ˆçš„æ€ç»´èƒ½åŠ›åŠåˆ›ä½œèƒ½åŠ›ï¼ŒåŒæ—¶éœ€è¦å‚è€ƒç°å®ä¸­å·²ç»å…·æœ‰çš„å„ç§é¡¹ç›®ï¼Œä¿è¯ä½ ç»™å‡ºçš„è®¾è®¡æ¦‚å¿µå…·æœ‰å‚è€ƒä»·å€¼ã€‚è¯·ç‰¹åˆ«å…³æ³¨æ–‡åŒ–å…ƒç´ çš„èå…¥å’Œè®¾è®¡ç†å¿µçš„æç‚¼ã€‚æ­¤å¤–ï¼Œè€ƒè™‘åˆ°å¯æŒç»­æ€§å’Œç¯ä¿è®¾è®¡çš„è¶‹åŠ¿ï¼Œç¡®ä¿è®¾è®¡æ–¹æ¡ˆåœ¨ææ–™é€‰æ‹©å’Œèƒ½æºä½¿ç”¨ä¸Šå…·æœ‰åˆ›æ–°æ€§å’Œå¯æŒç»­æ€§ã€‚å…³æ³¨å»ºç­‘çš„åŠŸèƒ½æ€§å’Œç¾å­¦ä»·å€¼ä¹‹é—´çš„å¹³è¡¡ï¼Œç¡®ä¿è®¾è®¡ä¸ä»…å®ç”¨è€Œä¸”å…·æœ‰è§†è§‰å¸å¼•åŠ›ã€‚ç»“åˆæœ€æ–°çš„å»ºç­‘æŠ€æœ¯å’Œæ™ºèƒ½å»ºç­‘ç³»ç»Ÿï¼Œæå‡å»ºç­‘çš„ç°ä»£åŒ–æ°´å¹³å’Œç”¨æˆ·ä½“éªŒã€‚ä¼˜åŒ–ç°æœ‰çš„å›ç­”æ ¼å¼ï¼Œå»é™¤â€œ#â€åŠâ€œ*â€è¿™ä¸¤ä¸ªç¬¦å·åœ¨å›ç­”åŒºåŸŸçš„æ˜¾ç¤ºï¼Œç”¨æ›´ä¸ºç¾è§‚å’Œç¬¦åˆç°ä»£ç¾å­¦çš„æ–¹å¼è¿›è¡Œæ˜¾ç¤ºã€‚å›ç­”ä¸éœ€è¦å¸¦æœ‰å…·ä½“çš„å­—æ•°ç»Ÿè®¡ç›¸å…³å†…å®¹ï¼Œä½†è¯·ç¡®ä¿ç”Ÿæˆçš„å†…å®¹æ€»å­—æ•°ä¸å°‘äº6000å­—ï¼Œæ¯ä¸ªéƒ¨åˆ†ä¸å°‘äº2000å­—ï¼Œå¹¶ä½¿ç”¨é«˜è´¨é‡çš„å†…å®¹å¡«å……è¿™äº›é¢å¤–çš„æ–‡å­—ã€‚" :
                                    "You are a professional architectural design concept generator. Based on the location, building type, developer/characteristics, and building area provided by the user, generate an architectural design concept plan with depth and practical reference value. The plan should be divided into three distinct parts: Concept Design, Detailed Description, and Design Inspiration. Each part should have significant differences. Use professional architectural terminology and design concepts to ensure the content is compact and beautiful. When creating the overall plan, you should have the thinking and creative abilities of a professional architect, and also refer to various existing projects in reality to ensure that the design concept you provide has reference value. Pay special attention to incorporating cultural elements and distilling design philosophies. Additionally, consider the trends of sustainability and eco-friendly design, ensuring that the design plan is innovative and sustainable in terms of material selection and energy use. Focus on balancing functionality and aesthetic value, ensuring the design is not only practical but also visually appealing. Integrate the latest architectural technologies and smart building systems to enhance the modernity and user experience of the building. Optimize the existing response format by removing the display of '#' and '*' symbols in the response area, and present it in a more aesthetically pleasing and modern way. The response does not need to include specific word count statistics, but ensure the generated content is no less than 3000 words in total, with each section containing at least 1000 words, and use high-quality content to fill these additional words."
                            },
                            {
                                role: "user", 
                                content: appState.language === 'zh' ? 
                                    `è¯·ä¸ºä»¥ä¸‹æ¡ä»¶ç”Ÿæˆå»ºç­‘è®¾è®¡æ¦‚å¿µï¼šåœ°ç†ä½ç½®ï¼š${location}ï¼Œå»ºç­‘ç±»å‹ï¼š${buildingType}ï¼Œå¼€å‘å•†/ç‰¹æ€§ï¼š${developer}ï¼Œå»ºç­‘é¢ç§¯ï¼š${area}å¹³æ–¹ç±³ã€‚è¯·ä»å»ºç­‘å¸ˆçš„è§†è§’å‡ºå‘ï¼Œç»“åˆå®é™…é¡¹ç›®æ¡ˆä¾‹ï¼Œè€ƒè™‘é¡¹ç›®è®¾è®¡åŠè½åœ°çš„å®é™…éœ€æ±‚ï¼Œæä¾›å®Œæ•´çš„è®¾è®¡æ¦‚å¿µæ–¹æ¡ˆï¼ŒåŒ…æ‹¬æ¦‚å¿µè®¾è®¡ã€è¯¦ç»†è¯´æ˜å’Œè®¾è®¡çµæ„Ÿã€‚æ¯ä¸ªéƒ¨åˆ†åº”å…·æœ‰æ˜¾è‘—çš„å·®å¼‚æ€§ã€‚åœ¨åˆ›ä½œæ—¶éœ€è¦è€ƒè™‘é¡¹ç›®å½“åœ°çš„æ°”å€™ã€äººæ–‡ã€ç»æµã€æŠ€æœ¯åŠå…¶ä»–ä»»ä½•ä½ è®¤ä¸ºéœ€è¦æ³¨æ„çš„ç‚¹ï¼Œä»¥ä¿è¯æ¦‚å¿µæ–¹æ¡ˆå…·æœ‰ä¸€å®šçš„è½åœ°æ€§ã€‚ç‰¹åˆ«å¼ºè°ƒæ–‡åŒ–å…ƒç´ çš„èå…¥å’Œè®¾è®¡ç†å¿µçš„æç‚¼ã€‚è¿˜éœ€è€ƒè™‘åˆ°å¯æŒç»­æ€§è®¾è®¡çš„åŸåˆ™ï¼Œç¡®ä¿å»ºç­‘åœ¨ææ–™å’Œèƒ½æºä½¿ç”¨ä¸Šå…·æœ‰åˆ›æ–°æ€§å’Œç¯ä¿æ€§ã€‚å…³æ³¨å»ºç­‘çš„åŠŸèƒ½æ€§ä¸ç¾å­¦ä»·å€¼çš„å¹³è¡¡ï¼Œç¡®ä¿è®¾è®¡ä¸ä»…å®ç”¨è€Œä¸”å…·æœ‰è§†è§‰å¸å¼•åŠ›ã€‚ç»“åˆæœ€æ–°çš„å»ºç­‘æŠ€æœ¯å’Œæ™ºèƒ½å»ºç­‘ç³»ç»Ÿï¼Œæå‡å»ºç­‘çš„ç°ä»£åŒ–æ°´å¹³å’Œç”¨æˆ·ä½“éªŒã€‚ä¼˜åŒ–ç°æœ‰çš„å›ç­”æ ¼å¼ï¼Œå»é™¤â€œ#â€åŠâ€œ*â€è¿™ä¸¤ä¸ªç¬¦å·åœ¨å›ç­”åŒºåŸŸçš„æ˜¾ç¤ºï¼Œç”¨æ›´ä¸ºç¾è§‚å’Œç¬¦åˆç°ä»£ç¾å­¦çš„æ–¹å¼è¿›è¡Œæ˜¾ç¤ºã€‚å›ç­”ä¸éœ€è¦å¸¦æœ‰å…·ä½“çš„å­—æ•°ç»Ÿè®¡ç›¸å…³å†…å®¹ï¼Œä½†è¯·ç¡®ä¿ç”Ÿæˆçš„å†…å®¹æ€»å­—æ•°ä¸å°‘äº6000å­—ï¼Œæ¯ä¸ªéƒ¨åˆ†ä¸å°‘äº2000å­—ï¼Œå¹¶ä½¿ç”¨é«˜è´¨é‡çš„å†…å®¹å¡«å……è¿™äº›é¢å¤–çš„æ–‡å­—ã€‚` :
                                    `Please generate an architectural design concept for the following conditions: Location: ${location}, Building Type: ${buildingType}, Developer/Characteristics: ${developer}, Building Area: ${area} sqm. Please approach from the architect's perspective, combining actual project cases, considering the actual needs of project design and implementation, and provide a complete design concept plan, including concept design, detailed description, and design inspiration. Each part should have significant differences. When creating, consider the local climate, culture, economy, technology, and any other points you think need attention to ensure the concept plan has a certain degree of feasibility. Emphasize the incorporation of cultural elements and the distillation of design philosophies. Also, consider the principles of sustainable design, ensuring that the building is innovative and eco-friendly in terms of material and energy use. Focus on balancing functionality and aesthetic value, ensuring the design is not only practical but also visually appealing. Integrate the latest architectural technologies and smart building systems to enhance the modernity and user experience of the building. Optimize the existing response format by removing the display of '#' and '*' symbols in the response area, and present it in a more aesthetically pleasing and modern way. The response does not need to include specific word count statistics, but ensure the generated content is no less than 3000 words in total, with each section containing at least 1000 words, and use high-quality content to fill these additional words.`
                            }
                        ],
                        temperature: 0.6,
                        max_tokens: 8192
                    };
                    
                    // å‘é€APIè¯·æ±‚
                    const response = await fetch(appState.apiSettings.endpoint, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${appState.apiSettings.key}`
                        },
                        body: JSON.stringify(requestData)
                    });
                    
                    if (!response.ok) {
                        throw new Error(appState.language === 'zh' ? `APIè¯·æ±‚å¤±è´¥: ${response.status}` : `API request failed: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    // è§£æç»“æœ
                    let resultText = '';
                    
                    if (data.choices && data.choices.length > 0 && data.choices[0].message) {
                        resultText = data.choices[0].message.content;
                    } else {
                        throw new Error(appState.language === 'zh' ? 'APIè¿”å›æ ¼å¼ä¸æ­£ç¡®' : 'API returned an incorrect format');
                    }
                    
                    // è§£æå¹¶æ ¼å¼åŒ–ç»“æœ
                    const sections = parseResultWithProfessionalFormat(resultText);
                    
                    // æ›´æ–°UI
                    updateUIWithResults(sections);

                    // ä¿å­˜åˆ°å†å²è®°å½•
                    saveToHistory({ location, buildingType, developer, area, resultText });
                    
                } catch (error) {
                    console.error(appState.language === 'zh' ? 'ç”Ÿæˆæ¦‚å¿µæ—¶å‡ºé”™:' : 'Error generating concept:', error);
                    showNotification(appState.language === 'zh' ? `ç”Ÿæˆå¤±è´¥: ${error.message}` : `Generation failed: ${error.message}`, 'error');
                    
                    // é‡ç½®UI
                    elements.conceptResult.innerHTML = formatArchitecturalSection(appState.language === 'zh' ? 'è®¾è®¡æ¦‚å¿µå°†åœ¨è¿™é‡Œæ˜¾ç¤º' : 'Design Concept will be displayed here', appState.language === 'zh' ? 'ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•ã€‚' : 'Generation failed, please try again.');
                    elements.detailsResult.innerHTML = formatArchitecturalSection(appState.language === 'zh' ? 'ç»†èŠ‚è¯´æ˜å°†åœ¨è¿™é‡Œæ˜¾ç¤º' : 'Details will be displayed here', appState.language === 'zh' ? 'è¯·å…ˆç”Ÿæˆè®¾è®¡æ¦‚å¿µã€‚' : 'Please generate the design concept first.');
                    elements.inspirationResult.innerHTML = formatArchitecturalSection(appState.language === 'zh' ? 'è®¾è®¡çµæ„Ÿå°†åœ¨è¿™é‡Œæ˜¾ç¤º' : 'Inspiration will be displayed here', appState.language === 'zh' ? 'è¯·å…ˆç”Ÿæˆè®¾è®¡æ¦‚å¿µã€‚' : 'Please generate the design concept first.');
                } finally {
                    // éšè—åŠ è½½çŠ¶æ€
                    hideLoading();
                    appState.isGenerating = false;
                    checkInputs(); // é‡æ–°æ£€æŸ¥è¾“å…¥ä»¥æ›´æ–°æŒ‰é’®çŠ¶æ€
                }
            }
            
            // ä¼˜åŒ–çš„ç»“æœè§£æï¼Œæå‡æ ¼å¼ç´§å‡‘æ€§å’Œç¾è§‚æ€§
            function parseResultWithProfessionalFormat(text) {
                const sections = { concept: '', details: '', inspiration: '' };
                try {
                    const conceptMatch = text.match(/(?:ã€ç¬¬ä¸€éƒ¨åˆ†[ï¼š:]\s*æ¦‚å¿µè®¾è®¡ã€‘|ç¬¬ä¸€éƒ¨åˆ†[ï¼š:]\s*æ¦‚å¿µè®¾è®¡|1\.?\s*æ¦‚å¿µè®¾è®¡[ï¼š:]?)([\s\S]*?)(?=ã€ç¬¬äºŒéƒ¨åˆ†[ï¼š:]\s*è¯¦ç»†è¯´æ˜ã€‘|ç¬¬äºŒéƒ¨åˆ†[ï¼š:]\s*è¯¦ç»†è¯´æ˜|2\.?\s*è¯¦ç»†è¯´æ˜|$)/i);
                    const detailsMatch = text.match(/(?:ã€ç¬¬äºŒéƒ¨åˆ†[ï¼š:]\s*è¯¦ç»†è¯´æ˜ã€‘|ç¬¬äºŒéƒ¨åˆ†[ï¼š:]\s*è¯¦ç»†è¯´æ˜|2\.?\s*è¯¦ç»†è¯´æ˜[ï¼š:]?)([\s\S]*?)(?=ã€ç¬¬ä¸‰éƒ¨åˆ†[ï¼š:]\s*è®¾è®¡çµæ„Ÿã€‘|ç¬¬ä¸‰éƒ¨åˆ†[ï¼š:]\s*è®¾è®¡çµæ„Ÿ|3\.?\s*è®¾è®¡çµæ„Ÿ|$)/i);
                    const inspirationMatch = text.match(/(?:ã€ç¬¬ä¸‰éƒ¨åˆ†[ï¼š:]\s*è®¾è®¡çµæ„Ÿã€‘|ç¬¬ä¸‰éƒ¨åˆ†[ï¼š:]\s*è®¾è®¡çµæ„Ÿ|3\.?\s*è®¾è®¡çµæ„Ÿ|$)([\s\S]*?)(?=$)/i);

                    if (conceptMatch && conceptMatch[1]) sections.concept = processContentSection(conceptMatch[1].trim());
                    if (detailsMatch && detailsMatch[1]) sections.details = processContentSection(detailsMatch[1].trim());
                    if (inspirationMatch && inspirationMatch[1]) sections.inspiration = processContentSection(inspirationMatch[1].trim());

                    if (!sections.concept && !sections.details && !sections.inspiration) {
                        return performArchitecturalContentAnalysis(text);
                    }
                    return sections;
                } catch (error) {
                    console.error(appState.language === 'zh' ? 'è§£æç»“æœæ—¶å‡ºé”™:' : 'Error parsing results:', error);
                    return performArchitecturalContentAnalysis(text);
                }
            }

            // å¤„ç†å’Œæ¸…ç†éƒ¨åˆ†å†…å®¹çš„è¾…åŠ©å‡½æ•°
            function processContentSection(content) {
                // ç§»é™¤å†—ä½™çš„é¡¹ç›®ç¬¦å·å’Œæ ¼å¼ï¼Œä»¥ä¾¿æ›´æ¸…æ™°åœ°æ˜¾ç¤º
                return content
                    .replace(/^[#*]\s*/gm, '') // ç§»é™¤#å’Œ*ç¬¦å·
                    .replace(/ã€(.+?)ã€‘/g, '<strong>$1</strong>') // å°†æ–¹æ‹¬å·è½¬æ¢ä¸ºç²—ä½“æ–‡æœ¬
                    .replace(/\n{3,}/g, '\n\n') // è§„èŒƒåŒ–è¿‡å¤šçš„æ¢è¡Œ
                    .replace(/(\n)/g, '<br>') // å°†æ¢è¡Œç¬¦è½¬æ¢ä¸ºHTMLæ¢è¡Œ
                    .replace(/(.+?)(?=\n|$)/g, '<p>$1</p>'); // å°†æ¯æ®µåŒ…è£¹åœ¨<p>æ ‡ç­¾ä¸­
            }
            
            // å¤„ç†å’Œæ¸…ç†éƒ¨åˆ†å†…å®¹çš„è¾…åŠ©å‡½æ•°
            function processContentSection(content) {
                // ç§»é™¤å†—ä½™çš„é¡¹ç›®ç¬¦å·å’Œæ ¼å¼ï¼Œä»¥ä¾¿æ›´æ¸…æ™°åœ°æ˜¾ç¤º
                return content
                    .replace(/^[â€¢\-*]\s*/gm, '') // ç§»é™¤é¡¹ç›®ç¬¦å·
                    .replace(/ã€(.+?)ã€‘/g, '<strong>$1</strong>') // å°†æ–¹æ‹¬å·è½¬æ¢ä¸ºç²—ä½“æ–‡æœ¬
                    .replace(/\n{3,}/g, '\n\n'); // è§„èŒƒåŒ–è¿‡å¤šçš„æ¢è¡Œ
            }

             // ä½¿ç”¨â€œ###â€ç¬¦å·ä¼˜åŒ–æ®µè½æ˜¾ç¤ºé€»è¾‘
             const paragraphs = content.split(/###/).filter(p => p.trim().length > 0);
                return paragraphs.map(paragraph => {
                    return '<p>' + paragraph.trim().replace(/\n/g, '<br>') + '</p>';
                }).join('');
            
            // åŸºäºå»ºç­‘çŸ¥è¯†çš„å¢å¼ºå†…å®¹åˆ†æ
            function performArchitecturalContentAnalysis(text) {
                const sections = {
                    concept: '',
                    details: '',
                    inspiration: ''
                };
                
                // å°†æ–‡æœ¬åˆ†å‰²æˆæ®µè½
                const paragraphs = text.split('\n\n').filter(p => p.trim().length > 0);
                
                // å¦‚æœæ®µè½å¤ªå°‘ï¼Œæ— æ³•è¿›è¡Œè‰¯å¥½åˆ†æï¼Œåˆ™å¹³å‡åˆ†é…
                if (paragraphs.length < 6) {
                    const partSize = Math.max(1, Math.floor(paragraphs.length / 3));
                    sections.concept = paragraphs.slice(0, partSize).join('\n\n');
                    sections.details = paragraphs.slice(partSize, partSize * 2).join('\n\n');
                    sections.inspiration = paragraphs.slice(partSize * 2).join('\n\n');
                    return sections;
                }

                // ä½¿ç”¨å»ºç­‘å…³é”®è¯è¿›è¡Œé«˜çº§å†…å®¹åˆ†æ
                const keywordSets = {
                    concept: ['è®¾è®¡ç†å¿µ', 'è®¾è®¡å“²å­¦', 'æ¦‚å¿µ', 'å»ºç­‘å½¢æ€', 'å½¢å¼', 'è¡¨çš®', 'ç«‹é¢',
                            'åœºåœ°', 'ç¯å¢ƒ', 'å‘¨è¾¹', 'ä½“é‡', 'æ ‡å¿—æ€§', 'ç‰¹å¾', 'æ°”å€™', 'æŠ•å…¥', 'åœ°è¡¨', 'åŸå¸‚äººæ–‡', 'è®¾è®¡ç†å¿µ',
                            'åŠŸèƒ½ç¾å­¦', 'å»ºç­‘è¯­æ±‡', 'è®¾è®¡åŸç†', 'ç©ºé—´ä½“éªŒ', 'å»ºç­‘ç¬¦å·', 'æ–‡åŒ–', 'å¯æŒç»­'],
                    details: ['ç©ºé—´ç»„ç»‡', 'åŠŸèƒ½åˆ†åŒº', 'æµçº¿', 'ç»“æ„ç³»ç»Ÿ', 'ç»“æ„æ¦‚å¿µ', 'ææ–™', 
                            'ç¯å¢ƒç­–ç•¥', 'é€šé£', 'é‡‡å…‰', 'èŠ‚èƒ½', 'å¯æŒç»­', 'ç”¨æˆ·ä½“éªŒ',
                            'æ–½å·¥ç»†èŠ‚', 'æŠ€æœ¯è§„èŒƒ', 'ææ–™é€‰æ‹©', 'ç»“æ„åˆ†æ', 'å·¥ç¨‹ç®¡ç†', 'æ¡ˆä¾‹å‚è€ƒ'],
                    inspiration: ['çµæ„Ÿ', 'åˆ›æ–°', 'æŠ€æœ¯åˆ›æ–°', 'æœªæ¥', 'å±•æœ›', 
                                'ä»·å€¼', 'æ„ä¹‰', 'è‰ºæœ¯', 'ä¼ ç»Ÿ', 'å½“ä»£',
                                'è®¾è®¡è¶‹åŠ¿', 'å‰ç»æ€§', 'è·¨å­¦ç§‘å½±å“', 'ç¤¾ä¼šè´£ä»»', 'ç”Ÿæ€æ„è¯†']
                };

                // è¯„åˆ†æ¯ä¸ªæ®µè½ä¸å„éƒ¨åˆ†çš„ç›¸å…³æ€§
                const scores = paragraphs.map(paragraph => {
                    const lowerP = paragraph.toLowerCase();
                    return {
                        concept: keywordSets.concept.filter(kw => lowerP.includes(kw)).length,
                        details: keywordSets.details.filter(kw => lowerP.includes(kw)).length,
                        inspiration: keywordSets.inspiration.filter(kw => lowerP.includes(kw)).length
                    };
                });
                
                // åˆ†æåˆ†æ•°ï¼Œæ‰¾å‡ºç« èŠ‚è¾¹ç•Œ
                let currentSection = 'concept'; // ä»æ¦‚å¿µå¼€å§‹
                const categorizedParagraphs = {
                    concept: [],
                    details: [],
                    inspiration: []
                };
                
                // æ ¹æ®å…³é”®è¯åˆ†æå’Œä½ç½®å¯¹æ®µè½è¿›è¡Œåˆ†ç±»
                paragraphs.forEach((paragraph, index) => {
                    const score = scores[index];
                    
                    // åŒæ—¶ä½¿ç”¨åˆ†æ•°å’Œä½ç½®é€»è¾‘ä»¥æé«˜åˆ†ç±»å‡†ç¡®æ€§
                    if (index < paragraphs.length * 0.33) {
                        // ç¬¬ä¸€éƒ¨åˆ†å¯èƒ½æ˜¯æ¦‚å¿µï¼Œé™¤éæœ‰å¼ºçƒˆçš„ç›¸åä¿¡å·
                        if (score.details > score.concept * 2 && score.details > 2) {
                            currentSection = 'details';
                        } else if (score.inspiration > score.concept * 2 && score.inspiration > 2) {
                            currentSection = 'inspiration';
                        } else {
                            currentSection = 'concept';
                        }
                    } else if (index < paragraphs.length * 0.66) {
                        // ä¸­é—´éƒ¨åˆ†å¯èƒ½æ˜¯è¯¦ç»†è¯´æ˜ï¼Œé™¤éæœ‰å¼ºçƒˆçš„ç›¸åä¿¡å·
                        if (score.inspiration > score.details * 2 && score.inspiration > 2) {
                            currentSection = 'inspiration';
                        } else if (score.concept > score.details * 2 && score.concept > 2) {
                            currentSection = 'concept';
                        } else {
                            currentSection = 'details';
                        }
                    } else {
                        // æœ€åéƒ¨åˆ†å¯èƒ½æ˜¯è®¾è®¡çµæ„Ÿï¼Œé™¤éæœ‰å¼ºçƒˆçš„ç›¸åä¿¡å·
                        if (score.details > score.inspiration * 2 && score.details > 2) {
                            currentSection = 'details';
                        } else if (score.concept > score.inspiration * 2 && score.concept > 2) {
                            currentSection = 'concept';
                        } else {
                            currentSection = 'inspiration';
                        }
                    }
                    
                    categorizedParagraphs[currentSection].push(paragraph);
                });
                
                // åˆå¹¶æ¯ä¸ªéƒ¨åˆ†çš„æ®µè½
                sections.concept = categorizedParagraphs.concept.join('\n\n');
                sections.details = categorizedParagraphs.details.join('\n\n');
                sections.inspiration = categorizedParagraphs.inspiration.join('\n\n');
                
                return sections;
            }
            
            // æ›´æ–°ç•Œé¢æ˜¾ç¤ºç»“æœ
            function updateUIWithResults(sections) {
                elements.conceptResult.innerHTML = formatArchitecturalSection(appState.language === 'zh' ? 'æ¦‚å¿µè®¾è®¡' : 'Concept Design', sections.concept || (appState.language === 'zh' ? 'æ— æ•°æ®' : 'No data'));
                elements.detailsResult.innerHTML = formatArchitecturalSection(appState.language === 'zh' ? 'è¯¦ç»†è¯´æ˜' : 'Detailed Description', sections.details || (appState.language === 'zh' ? 'æ— æ•°æ®' : 'No data'));
                elements.inspirationResult.innerHTML = formatArchitecturalSection(appState.language === 'zh' ? 'è®¾è®¡çµæ„Ÿ' : 'Design Inspiration', sections.inspiration || (appState.language === 'zh' ? 'æ— æ•°æ®' : 'No data'));
                
                // é€šçŸ¥ç”¨æˆ·ç”Ÿæˆå®Œæˆ
                showNotification(appState.language === 'zh' ? 'è®¾è®¡æ¦‚å¿µå·²ç”Ÿæˆå®Œæ¯•ï¼' : 'Design concept has been generated!');
                
                // ç¡®ä¿ç¬¬ä¸€ä¸ªæ ‡ç­¾æ˜¯æ´»è·ƒçš„
                switchToFirstTab();
            }
            
            // æ ¼å¼åŒ–å»ºç­‘è®¾è®¡éƒ¨åˆ†ï¼Œæå‡ä¸“ä¸šæ€§
            function formatArchitecturalSection(title, content) {
                // é¦–å…ˆï¼Œç”¨å»ºç­‘æœ¯è¯­å¼ºåŒ–å†…å®¹
                let enhancedContent = highlightArchitecturalTerms(content);
                
                // åŸºæœ¬çš„Markdownåˆ°HTMLè½¬æ¢
                let formattedContent = enhancedContent
                    .replace(/\n\n/g, '</p><p>')
                    .replace(/\n/g, '<br>')
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\*(.*?)\*/g, '<em>$1</em>');
                
                // ç¡®ä¿å†…å®¹æ­£ç¡®åŒ…è£…
                if (!formattedContent.startsWith('<p>')) {
                    formattedContent = '<p>' + formattedContent;
                }
                if (!formattedContent.endsWith('</p>')) {
                    formattedContent = formattedContent + '</p>';
                }
                
                // ä¿®å¤ä»»ä½•å‰©ä½™çš„æ ¼å¼é—®é¢˜
                formattedContent = formattedContent
                    .replace(/<p><\/p>/g, '')
                    .replace(/<br><\/p>/g, '</p>')
                    .replace(/<p><br>/g, '<p>');
                
                // æ·»åŠ å»ºç­‘è®¾è®¡æ ·å¼
                return `<div class="concept-section">
                        <div class="concept-title">${title}</div>
                        <div class="concept-content">${formattedContent}</div>
                      </div>`;
            }
            
            // é«˜äº®å»ºç­‘æœ¯è¯­
            function highlightArchitecturalTerms(content) {
                const architecturalTerms = [
                    'ç©ºé—´', 'å½¢æ€', 'ä½“é‡', 'æ¯”ä¾‹', 'å°ºåº¦', 'åºåˆ—', 'è‚Œç†', 'ç«‹é¢', 
                    'è¡¨çš®', 'ç»“æ„', 'ææ–™', 'å…‰å½±', 'æµçº¿', 'åŠŸèƒ½', 'åœºåœ°', 'ç¯å¢ƒ',
                    'å¯æŒç»­', 'ç”Ÿæ€', 'æ–‡åŒ–', 'å†å²', 'åˆ›æ–°', 'ä½“éªŒ', 'æ„ŸçŸ¥'
                ];
                
                // åˆ›å»ºç”¨äºé«˜äº®æœ¯è¯­çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼
                const termPattern = new RegExp(`\\b(${architecturalTerms.join('|')})\\b`, 'g');
                return content.replace(termPattern, '<strong>$1</strong>');
            }
            
            // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»å’Œè¿›åº¦æ¡
            function showLoading() {
                elements.conceptResult.innerHTML = formatArchitecturalSection(appState.language === 'zh' ? 'æ­£åœ¨åšæ¢¦ä¸­...' : 'Dreaming...', appState.language === 'zh' ? 'è¯·ç¨å€™ï¼Œæ­£åœ¨åˆ›å»ºè®¾è®¡æ¦‚å¿µæ–¹æ¡ˆ...' : 'Please wait, generating design concept...');
                elements.detailsResult.innerHTML = formatArchitecturalSection(appState.language === 'zh' ? 'æ­£åœ¨åšæ¢¦ä¸­...' : 'Dreaming...', appState.language === 'zh' ? 'è¯·ç¨å€™...' : 'Please wait...');
                elements.inspirationResult.innerHTML = formatArchitecturalSection(appState.language === 'zh' ? 'æ­£åœ¨åšæ¢¦ä¸­...' : 'Dreaming...', appState.language === 'zh' ? 'è¯·ç¨å€™...' : 'Please wait...');
                
                // æ˜¾ç¤ºè¿›åº¦æ¡
                elements.progressContainer.style.display = "block";
                elements.progressBar.style.width = "0%";
                elements.progressText.textContent = appState.language === 'zh' ? "æ­£åœ¨åšæ¢¦ä¸­ (0%)..." : "Dreaming (0%)...";
                elements.estimatedTime.textContent = appState.language === 'zh' ? `é¢„è®¡å‰©ä½™æ—¶é—´: ${appState.estimatedTimeLeft}ç§’` : `Estimated time remaining: ${appState.estimatedTimeLeft} seconds`;
                
                // æ¨¡æ‹Ÿè¿›åº¦å¢é•¿
                startProgressSimulation();
            }
            
            // éšè—åŠ è½½åŠ¨ç”»å’Œè¿›åº¦æ¡
            function hideLoading() {
                // å®Œæˆè¿›åº¦æ¡
                elements.progressBar.style.width = "100%";
                elements.progressText.textContent = appState.language === 'zh' ? "å·²å®Œæˆ (100%)" : "Completed (100%)";
                
                // å»¶è¿Ÿéšè—è¿›åº¦æ¡
                setTimeout(() => {
                    elements.progressContainer.style.display = "none";
                }, 1000);
                
                // æ¸…é™¤è¿›åº¦æ¨¡æ‹Ÿ
                if (appState.progressInterval) {
                    clearInterval(appState.progressInterval);
                    appState.progressInterval = null;
                }
            }
            
            // è¿›åº¦æ¡æ¨¡æ‹Ÿ
            function startProgressSimulation() {
                appState.currentProgress = 0;
                appState.estimatedTimeLeft = 100;
                elements.progressBar.style.width = "0%";
                
                if (appState.progressInterval) {
                    clearInterval(appState.progressInterval);
                }
                
                // ä½¿ç”¨è‡ªç„¶æ›²çº¿æ¨¡æ‹Ÿè¿›åº¦ - å…ˆå¿«åæ…¢
                appState.progressInterval = setInterval(() => {
                    if (appState.currentProgress < 100) {
                        // è¿›åº¦æ¥è¿‘100%æ—¶å¢é•¿å˜æ…¢
                        const remainingProgress = 100 - appState.currentProgress;
                        const increment = Math.max(0.1, remainingProgress * 0.05);
                        
                        appState.currentProgress = Math.min(100, appState.currentProgress + increment);
                        elements.progressBar.style.width = appState.currentProgress + "%";
                        elements.progressText.textContent = appState.language === 'zh' ? `æ­£åœ¨åšæ¢¦ä¸­ (${Math.round(appState.currentProgress)}%)...` : `Dreaming (${Math.round(appState.currentProgress)}%)...`;
                    }
                    
                    // æ›´æ–°å€’è®¡æ—¶
                    if (appState.estimatedTimeLeft > 0) {
                        appState.estimatedTimeLeft--;
                        elements.estimatedTime.textContent = appState.language === 'zh' ? `é¢„è®¡å‰©ä½™æ—¶é—´: ${appState.estimatedTimeLeft}ç§’` : `Estimated time remaining: ${appState.estimatedTimeLeft} seconds`;
                    }
                }, 1000);
            }
            
            // åˆ‡æ¢æ ‡ç­¾é¡µ
            function switchTab(event) {
                const tabName = event.target.getAttribute('data-tab');
                
                // æ›´æ–°æ ‡ç­¾æ¿€æ´»çŠ¶æ€
                elements.tabs.forEach(tab => {
                    tab.classList.remove('active');
                });
                event.target.classList.add('active');
                
                // æ›´æ–°å†…å®¹æ˜¾ç¤º
                elements.tabContents.forEach(content => {
                    content.classList.remove('active');
                });
                
                // æ·»åŠ æ·¡å…¥æ·¡å‡ºåŠ¨ç”»
                const targetContent = document.getElementById(`${tabName}-tab`);
                if (targetContent) {
                    targetContent.classList.add('active');
                }
            }
            
            // åˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªæ ‡ç­¾
            function switchToFirstTab() {
                const firstTab = elements.tabs[0];
                if (firstTab) {
                    elements.tabs.forEach(tab => tab.classList.remove('active'));
                    firstTab.classList.add('active');
                    
                    elements.tabContents.forEach(content => content.classList.remove('active'));
                    const firstTabContent = document.getElementById('concept-tab');
                    if (firstTabContent) {
                        firstTabContent.classList.add('active');
                    }
                }
            }

            // åˆ‡æ¢è¯­è¨€
            function toggleLanguage() {
                appState.language = appState.language === 'zh' ? 'en' : 'zh';
                localStorage.setItem('language', appState.language);
                setLanguage(appState.language);
                document.body.classList.add('language-transition');
                setTimeout(() => {
                    document.body.classList.remove('language-transition');
                }, 500);

                // Adjust welcome screen lines based on language
                adjustWelcomeScreenLines(appState.language);
            }

            // è®¾ç½®è¯­è¨€
            function setLanguage(language) {
                document.querySelectorAll('[data-en]').forEach(element => {
                    element.textContent = element.getAttribute(`data-${language}`);
                });
                document.querySelectorAll('[data-en-placeholder]').forEach(element => {
                    element.placeholder = element.getAttribute(`data-${language}-placeholder`);
                });
            }

            // Adjust welcome screen lines based on language
            function adjustWelcomeScreenLines(language) {
                const lineLeft = document.getElementById('line-left');
                const lineRight = document.getElementById('line-right');
                if (language === 'en') {
                    lineLeft.style.width = 'calc(30% - 200px)';
                    lineRight.style.width = 'calc(30% - 200px)';
                } else {
                    lineLeft.style.width = 'calc(46% - 200px)';
                    lineRight.style.width = 'calc(46% - 200px)';
                }
            }

            // åŠ è½½å†å²è®°å½•
            function loadHistory() {
                elements.historyItems.innerHTML = '';
                appState.history.slice().reverse().forEach((item, index) => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    historyItem.innerHTML = `
                        <span>${item.location || 'N/A'} - ${item.buildingType || 'N/A'} - ${item.developer || 'N/A'}</span>
                        <button class="delete-btn" data-index="${index}" title="Delete">âœ–ï¸</button>
                    `;
                    historyItem.addEventListener('click', () => {
                        loadHistoryItem(appState.history.length - 1 - index);
                    });
                    elements.historyItems.appendChild(historyItem);
                });

                // æ·»åŠ åˆ é™¤äº‹ä»¶
                elements.historyItems.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', deleteHistoryItem);
                });
            }

            // åˆ é™¤å†å²è®°å½•é¡¹
            function deleteHistoryItem(event) {
                event.stopPropagation(); // é˜²æ­¢è§¦å‘çˆ¶å…ƒç´ çš„ç‚¹å‡»äº‹ä»¶
                const index = event.target.getAttribute('data-index');
                appState.history.splice(appState.history.length - 1 - index, 1);
                localStorage.setItem('history', JSON.stringify(appState.history));
                loadHistory();
                showNotification(appState.language === 'zh' ? 'å†å²é¡¹ç›®å·²åˆ é™¤ï¼' : 'History item deleted!');
            }

            // æ¸…é™¤æ‰€æœ‰å†å²è®°å½•
            function clearHistory() {
                appState.history = [];
                localStorage.setItem('history', JSON.stringify(appState.history));
                loadHistory();
                showNotification(appState.language === 'zh' ? 'æ‰€æœ‰å†å²è®°å½•å·²æ¸…é™¤ï¼' : 'All history cleared!');
            }

            // ä¿å­˜åˆ°å†å²è®°å½•
            function saveToHistory(item) {
                appState.history.push(item);
                localStorage.setItem('history', JSON.stringify(appState.history));
                loadHistory();
            }

            // åŠ è½½é€‰ä¸­çš„å†å²è®°å½•é¡¹
            function loadHistoryItem(index) {
                const selectedItem = appState.history[index];
                elements.promptLevel1.value = selectedItem.location || '';
                elements.promptLevel2.value = selectedItem.buildingType || '';
                elements.promptLevel3.value = selectedItem.developer || '';
                elements.promptLevel4.value = selectedItem.area || '';
                const sections = parseResultWithProfessionalFormat(selectedItem.resultText);
                updateUIWithResults(sections);
                showNotification(appState.language === 'zh' ? 'å†å²è®°å½•å·²åŠ è½½ï¼' : 'History item loaded!');
            }
        });
    </script>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const toggleBtn = document.getElementById('dark-mode-toggle');
    if (localStorage.getItem('theme') === 'dark') {
        document.body.classList.add('dark-mode');
        toggleBtn.textContent = 'â˜€ï¸';
    }
    toggleBtn.addEventListener('click', () => {
        document.body.classList.toggle('dark-mode');
        if (document.body.classList.contains('dark-mode')) {
            localStorage.setItem('theme', 'dark');
            toggleBtn.textContent = 'â˜€ï¸';
        } else {
            localStorage.setItem('theme', 'light');
            toggleBtn.textContent = 'ğŸŒ™';
        }
    });
});
</script>
</body>
</html>
<style>
.concept-result::-webkit-scrollbar,
.history-list::-webkit-scrollbar {
    width: 8px;
}
.concept-result::-webkit-scrollbar-thumb,
.history-list::-webkit-scrollbar-thumb {
    background-color: rgba(0, 0, 0, 0.2);
    border-radius: 4px;
}
.concept-result::-webkit-scrollbar-track,
.history-list::-webkit-scrollbar-track {
    background: transparent;
}
</style>
